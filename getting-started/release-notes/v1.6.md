# KubeArmor v1.6 Release Notes

We are excited to announce the release of **KubeArmor v1.6**, packed with powerful new features, significant enhancements, and critical bug fixes that make workload protection and observability even more robust for cloud-native environments.

This release reflects major advancements in policy enforcement, system monitoring, and ecosystem integrations while addressing important stability and performance improvements.

### [Watch the KubeArmor v1.6 Release Overview](https://www.youtube.com/watch?v=lNXBwXRH-TQ)
<img src="https://github.com/user-attachments/assets/fbd6545c-2a7a-4ae4-91f5-87242a5b1c37" alt="KubeArmor v1.6 Release" width="600" />

## v1.6.6 (2026-01-28)

```json
{
  "üÜï New Features": [
    "Added configurable process-argument matching so policies can allow or restrict commands based on their runtime arguments. This exposes `allowedArgs` in the policy schema (up to 20 args), captures `execve` argv in BPF, propagates allowed args into new BPF maps, and enforces them in LSM exec rules with tests, samples, and documentation.",
    "Added configuration options to control visibility behavior at runtime, including namespace tracking and log verbosity. This makes the untracked-namespaces setting runtime-updatable via an atomic value and adds a flag to omit the `Resource` field from process visibility logs by updating log marshaling accordingly.",
    "Added safer cleanup behavior to prevent accidental deletion of critical paths during runtime cleanup. This introduces safe path-removal helpers that refuse to delete empty or root paths, applies them across cleanup code, and loads `SELinuxProfileDir` from the `ConfigSELinuxProfileDir` configuration key during `LoadConfig`.",
    "Added the ability to explicitly disable LSM enforcement via configuration and propagate that intent through deployment options. This skips LSM detection and enforcer initialization when the LSM order is `none` or no supported LSM is available, sets the node enforcer to `none`, and propagates LSM order through shared operator/snitch option structs into DaemonSet and CLI arguments."
  ],
  "üéÅ Misc": [
    "Improved codebase maintainability by modernizing Go usage and removing deprecated or unused constructs without changing behavior. This refactors multiple components to use newer Go idioms (e.g., `any`, `slices.Sort`, `maps.Copy`, `strings.SplitSeq`, `ReplaceAll`, and updated `switch` patterns), updates gRPC client construction to use non-deprecated insecure credentials, and cleans up unused parameters/variables.",
    "Updated CI and tests to be more reliable and consistent across environments. This switches block posture tests to an nginx-based app and adjusts various log/alert timeouts and sleeps in CI test workflows.",
    "Improved kernel/platform compatibility by narrowing special BPF compilation paths to the intended targets. This restricts special compilation handling and related macro usage to RHEL 9 kernels and updates the corresponding BPF conditional logic.",
    "Updated documentation to clarify supported environments and usage examples. This documents BPF-LSM and CentOS 9 support, clarifies Vagrant usage examples, and annotates the CentOS 9 kernel version in the Vagrantfile.",
    "Updated security scanning and release packaging metadata to current versions. This upgrades the CodeQL GitHub Action from v3 to v4, updates builder/runtime Alpine base images, and bumps KubeArmor/KubeArmorOperator Helm chart and app versions while updating the stable release version from v1.6.5 to v1.6.6.",
    "Updated repository headers to reflect the current year without functional changes. This changes all KubeArmor copyright headers to use year 2026 across the codebase.",
    "Refactored CLI/operator option handling to reduce duplication and keep configuration consistent across components. This centralizes operator options into shared structs, refactors snitch configuration into `SnitchOptions`, and updates flag parsing and usage accordingly."
  ],
  "üêú Bug Fixes": [
    "Fixed unsafe handling of protocol name strings in the `tcp_connect` path to avoid invalid memory access in BPF programs. This reads the protocol name into a fixed local stack buffer using `bpf_probe_read_str` instead of directly using `skc_prot-\u003ename` when storing args.",
    "Fixed enforcement/key-size mismatches by tightening path and argument length limits to align CRDs and BPF map keys. This enforces 200-character limits for path/exec/arg fields in CRDs and BPF keys and reduces InnerKey `Path` and `Source` byte array sizes from 256 to 200 while improving BPF map cleanup and cleanup ordering."
  ]
}

```

## Key Features & Enhancements

### üîê **Advanced Process Arguments Matching**

- Introduced **argument-based matching for processes** in policies.

- Allows precise control over command-line arguments, enabling granular process enforcement.

- This feature is currently limited to BPFLSM.

- **Example policy:**

  ```yaml
  apiVersion: security.kubearmor.com/v1
  kind: KubeArmorPolicy
  metadata:
    name: allow-steampipe-args
  spec:
    selector:
      matchLabels:
        app: steampipe
    process:
      matchPaths:
      - path: /usr/bin/python3.6
        allowedArgs:
          - -m
          - modules.steampipe_aws
    action: Block
  ```

### ‚ûï **Add support for non-Kubernetes installation through the KubeArmor client**

### üì° **DNS Visibility at Pod-Level**

- Added **DNS query tracing** on UDP to provide insights into domain lookups from workloads.
- Helps detect malicious behaviors like **DGA (Domain Generation Algorithms)** or unauthorized C2 communications.

### üõ°Ô∏è **New Policy Presets**

- **ProtectProc:** Blocks unauthorized access to the `/proc` directory by non-owner processes.
- **ProtectEnv:** Prevents unauthorized access to sensitive environment variables in `/proc/[pid]/environ`.
- **ExecPreset:** Enforces restrictions on external process executions (e.g., via `kubectl exec`).

### üîå **Container Runtime Enhancements**

- **OCI Hooks Support:**
  - Added support for **containerd** and **CRI-O hooks**, eliminating the need for exposing runtime UNIX sockets for container events.

### üìà **Improved Telemetry and Observability**

- Added **TTY information** in BPF-LSM generated telemetry.
- Enhanced telemetry with **network metadata** using Kubernetes informers.
- Extended alert resources to include **full command arguments**.

### üåê **Ecosystem and Integrations**

- **OpenSearch Support:** Added OpenSearch as a datasource for process graphs in Grafana dashboards.
- Integrated **image vulnerability scanning workflows** (via Trivy) in release pipelines.

## üõ†Ô∏è Bug Fixes and Stability Improvements

- Resolved **memory leaks** in AppArmor DaemonSet (observed in AKS clusters).
- Fixed **policy deletion logic** for recommended policies in the operator.
- Addressed **KubeArmorClusterPolicy enforcement issue** for pods created post-policy application.
- Fixed panic errors with uninitialized Docker daemons.
- Resolved **tolerations propagation issues** in Helm chart deployments.
- Improved filtering logic in `karmor profile` commands to respect namespace, pod, and container filters.
- Fixed PID/HostPID and PPID/HostPPID display anomalies (e-notation issues).

## ‚öôÔ∏è Additional Improvements

- Helm charts updated to handle tolerations properly.
- Introduced **conditional deployment** of pod refresh controllers.
- Updated CI pipelines to use Ubuntu 22.04 runners and separated network tests for newer kernels.
- Deprecated legacy Config Watcher in favor of **karmor.yaml configuration**.

## üö® Breaking Changes

- **Preset API Specification Updated:**

  - Action is now defined per-preset level:

    ```yaml
    presets:
      - name: protectEnv
        action: Block
    ```

- Configuration changes via `karmor.yaml` will eventually replace existing ConfigMap fields.

## üìñ Documentation Updates

- Revised hardening policies and presets documentation.
- Updated multi-OS deployment instructions and CLI long descriptions.
- Added ModelArmor use-cases and a better getting started guide

## ‚úÖ Upgrade Notes

- Users are advised to review preset configurations and update CRDs accordingly.
- When upgrading from v1.5, ensure Helm charts are updated to leverage new toleration handling and configuration management features.

## üìå Contributors

This release wouldn‚Äôt have been possible without the incredible contributions from the community. Special thanks to all contributors for feature development, bug fixes, and reviews. üôå

## üîó Resources

- üìö [KubeArmor Documentation](https://docs.kubearmor.io/)
- üõ†Ô∏è [GitHub Repository](https://github.com/kubearmor/KubeArmor)
- üìù [Changelog](https://github.com/kubearmor/KubeArmor/releases)
