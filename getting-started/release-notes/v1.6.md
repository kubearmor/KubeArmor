# KubeArmor v1.6 Release Notes

We are excited to announce the release of **KubeArmor v1.6**, packed with powerful new features, significant enhancements, and critical bug fixes that make workload protection and observability even more robust for cloud-native environments.

This release reflects major advancements in policy enforcement, system monitoring, and ecosystem integrations while addressing important stability and performance improvements.

## v1.6.6

**Date:** 2026-01-28  
**Version:** v1.6.6

### üÜï New Features

```json
{
  "üÜï New Features": [
    "You can now match on process arguments when writing process execution policies, making it possible to scope rules more precisely to how a binary is invoked. This adds `allowedArgs` to the process-path CRDs (with documented limits), enables eBPF-based argument capture/matching behind a config toggle, and propagates rules and cleanup behavior through the Go control-plane, operator, and tests.",
    "You can now use process-argument matching with owner-only enforcement so that ownership-based rules can also consider how a process was started. This extends owner-only enforcement to honor `allowedArgs`, updates the BPF argument capture and map cleanup paths, and adds documentation describing constraints and usage."
  ],
  "üéÅ Misc": [
    "The project has been updated to newer Go conventions without changing user-visible behavior. Multiple packages were refactored to use modern Go idioms and helpers (for example `any`, `slices.Sort`, `maps.Copy`, `strings.SplitSeq`, `ReplaceAll`, and simplified `switch` patterns) and the gRPC client setup was updated to use non-deprecated insecure credentials APIs.",
    "Build, release, and CI dependencies were refreshed to align with the latest supported tooling. This updates the CodeQL GitHub Action from v3 to v4, bumps the builder/runtime Alpine base images, and updates the KubeArmor and KubeArmorOperator Helm chart/app versions and stable release version to v1.6.6.",
    "CI posture tests were made more reliable by using a simpler test application and adjusting timeouts. The block-posture test workload was switched to an nginx-based app and several CI waits/sleeps and log/alert timeouts were increased to reduce flakiness.",
    "Certain special BPF compilation and macro behavior is now limited to the specific kernel family it was intended for. The special-case compilation handling and related macro usage are restricted to RHEL 9 kernels via updated BPF code conditionals.",
    "You can now control which Kubernetes namespaces are excluded from monitoring without rebuilding or redeploying binaries. Untracked namespaces are read at runtime from a ConfigMap-backed, globally atomic list rather than being copied into a `SystemMonitor` instance.",
    "You can now choose to omit the Resource field from process visibility logs when it is not needed. This adds a configuration flag exposed via operator/ConfigMap/CLI, refactors visibility-log marshaling accordingly, and includes tests and documentation for the behavior.",
    "Path-related BPF key sizes were tuned to better fit smaller map key constraints. This reduces the `InnerKey` `Path` and `Source` byte array sizes from 256 to 200 to keep BPF map keys within tighter limits.",
    "The runtime no longer tries to initialize an enforcement backend when enforcement is explicitly disabled, which avoids unnecessary setup work and confusing failures. If no LSM is configured (including explicit LSM order `none`), initialization is skipped, the node enforcer is normalized to `none`, and the disabled state is logged; the operator also propagates the LSM setting as a flag into generated DaemonSets and Snitch jobs.",
    "CLI and operator configuration have been reorganized to make configuration handling more consistent across components. The snitch CLI settings were refactored into a `SnitchOptions` struct, and operator configuration was similarly moved into an options struct with updated propagation paths.",
    "Cleanup routines are now safer by preventing accidental deletion of overly broad filesystem paths. New safe remove helpers refuse to delete empty or root paths and replace direct `os.Remove`/`os.RemoveAll` calls in several cleanup paths, and `GlobalCfg.SELinuxProfileDir` is now explicitly populated from the `ConfigSELinuxProfileDir` Viper key during `LoadConfig`.",
    "Repository-wide headers and documentation were brought up to date to reflect the current year and platform requirements. Copyright headers were updated to year 2026, and documentation now clarifies BPF-LSM/kernel requirements (including CentOS 9 details), security module defaults, and Vagrant usage examples."
  ],
  "üêú Bug Fixes": [
    "Network connect events no longer risk reading an invalid protocol-name pointer when capturing metadata for policy decisions and visibility. The `tcp_connect` protocol name is now copied into a fixed local stack buffer using `bpf_probe_read_str` before being stored in event arguments, instead of directly using `skc_prot-\u003ename`."
  ]
}

```

### üêõ Bug Fixes

```json
{
  "üÜï New Features": [
    "You can now match on process arguments when writing process execution policies, making it possible to scope rules more precisely to how a binary is invoked. This adds `allowedArgs` to the process-path CRDs (with documented limits), enables eBPF-based argument capture/matching behind a config toggle, and propagates rules and cleanup behavior through the Go control-plane, operator, and tests.",
    "You can now use process-argument matching with owner-only enforcement so that ownership-based rules can also consider how a process was started. This extends owner-only enforcement to honor `allowedArgs`, updates the BPF argument capture and map cleanup paths, and adds documentation describing constraints and usage."
  ],
  "üéÅ Misc": [
    "The project has been updated to newer Go conventions without changing user-visible behavior. Multiple packages were refactored to use modern Go idioms and helpers (for example `any`, `slices.Sort`, `maps.Copy`, `strings.SplitSeq`, `ReplaceAll`, and simplified `switch` patterns) and the gRPC client setup was updated to use non-deprecated insecure credentials APIs.",
    "Build, release, and CI dependencies were refreshed to align with the latest supported tooling. This updates the CodeQL GitHub Action from v3 to v4, bumps the builder/runtime Alpine base images, and updates the KubeArmor and KubeArmorOperator Helm chart/app versions and stable release version to v1.6.6.",
    "CI posture tests were made more reliable by using a simpler test application and adjusting timeouts. The block-posture test workload was switched to an nginx-based app and several CI waits/sleeps and log/alert timeouts were increased to reduce flakiness.",
    "Certain special BPF compilation and macro behavior is now limited to the specific kernel family it was intended for. The special-case compilation handling and related macro usage are restricted to RHEL 9 kernels via updated BPF code conditionals.",
    "You can now control which Kubernetes namespaces are excluded from monitoring without rebuilding or redeploying binaries. Untracked namespaces are read at runtime from a ConfigMap-backed, globally atomic list rather than being copied into a `SystemMonitor` instance.",
    "You can now choose to omit the Resource field from process visibility logs when it is not needed. This adds a configuration flag exposed via operator/ConfigMap/CLI, refactors visibility-log marshaling accordingly, and includes tests and documentation for the behavior.",
    "Path-related BPF key sizes were tuned to better fit smaller map key constraints. This reduces the `InnerKey` `Path` and `Source` byte array sizes from 256 to 200 to keep BPF map keys within tighter limits.",
    "The runtime no longer tries to initialize an enforcement backend when enforcement is explicitly disabled, which avoids unnecessary setup work and confusing failures. If no LSM is configured (including explicit LSM order `none`), initialization is skipped, the node enforcer is normalized to `none`, and the disabled state is logged; the operator also propagates the LSM setting as a flag into generated DaemonSets and Snitch jobs.",
    "CLI and operator configuration have been reorganized to make configuration handling more consistent across components. The snitch CLI settings were refactored into a `SnitchOptions` struct, and operator configuration was similarly moved into an options struct with updated propagation paths.",
    "Cleanup routines are now safer by preventing accidental deletion of overly broad filesystem paths. New safe remove helpers refuse to delete empty or root paths and replace direct `os.Remove`/`os.RemoveAll` calls in several cleanup paths, and `GlobalCfg.SELinuxProfileDir` is now explicitly populated from the `ConfigSELinuxProfileDir` Viper key during `LoadConfig`.",
    "Repository-wide headers and documentation were brought up to date to reflect the current year and platform requirements. Copyright headers were updated to year 2026, and documentation now clarifies BPF-LSM/kernel requirements (including CentOS 9 details), security module defaults, and Vagrant usage examples."
  ],
  "üêú Bug Fixes": [
    "Network connect events no longer risk reading an invalid protocol-name pointer when capturing metadata for policy decisions and visibility. The `tcp_connect` protocol name is now copied into a fixed local stack buffer using `bpf_probe_read_str` before being stored in event arguments, instead of directly using `skc_prot-\u003ename`."
  ]
}

```

### üéÅ Misc

```json
{
  "üÜï New Features": [
    "You can now match on process arguments when writing process execution policies, making it possible to scope rules more precisely to how a binary is invoked. This adds `allowedArgs` to the process-path CRDs (with documented limits), enables eBPF-based argument capture/matching behind a config toggle, and propagates rules and cleanup behavior through the Go control-plane, operator, and tests.",
    "You can now use process-argument matching with owner-only enforcement so that ownership-based rules can also consider how a process was started. This extends owner-only enforcement to honor `allowedArgs`, updates the BPF argument capture and map cleanup paths, and adds documentation describing constraints and usage."
  ],
  "üéÅ Misc": [
    "The project has been updated to newer Go conventions without changing user-visible behavior. Multiple packages were refactored to use modern Go idioms and helpers (for example `any`, `slices.Sort`, `maps.Copy`, `strings.SplitSeq`, `ReplaceAll`, and simplified `switch` patterns) and the gRPC client setup was updated to use non-deprecated insecure credentials APIs.",
    "Build, release, and CI dependencies were refreshed to align with the latest supported tooling. This updates the CodeQL GitHub Action from v3 to v4, bumps the builder/runtime Alpine base images, and updates the KubeArmor and KubeArmorOperator Helm chart/app versions and stable release version to v1.6.6.",
    "CI posture tests were made more reliable by using a simpler test application and adjusting timeouts. The block-posture test workload was switched to an nginx-based app and several CI waits/sleeps and log/alert timeouts were increased to reduce flakiness.",
    "Certain special BPF compilation and macro behavior is now limited to the specific kernel family it was intended for. The special-case compilation handling and related macro usage are restricted to RHEL 9 kernels via updated BPF code conditionals.",
    "You can now control which Kubernetes namespaces are excluded from monitoring without rebuilding or redeploying binaries. Untracked namespaces are read at runtime from a ConfigMap-backed, globally atomic list rather than being copied into a `SystemMonitor` instance.",
    "You can now choose to omit the Resource field from process visibility logs when it is not needed. This adds a configuration flag exposed via operator/ConfigMap/CLI, refactors visibility-log marshaling accordingly, and includes tests and documentation for the behavior.",
    "Path-related BPF key sizes were tuned to better fit smaller map key constraints. This reduces the `InnerKey` `Path` and `Source` byte array sizes from 256 to 200 to keep BPF map keys within tighter limits.",
    "The runtime no longer tries to initialize an enforcement backend when enforcement is explicitly disabled, which avoids unnecessary setup work and confusing failures. If no LSM is configured (including explicit LSM order `none`), initialization is skipped, the node enforcer is normalized to `none`, and the disabled state is logged; the operator also propagates the LSM setting as a flag into generated DaemonSets and Snitch jobs.",
    "CLI and operator configuration have been reorganized to make configuration handling more consistent across components. The snitch CLI settings were refactored into a `SnitchOptions` struct, and operator configuration was similarly moved into an options struct with updated propagation paths.",
    "Cleanup routines are now safer by preventing accidental deletion of overly broad filesystem paths. New safe remove helpers refuse to delete empty or root paths and replace direct `os.Remove`/`os.RemoveAll` calls in several cleanup paths, and `GlobalCfg.SELinuxProfileDir` is now explicitly populated from the `ConfigSELinuxProfileDir` Viper key during `LoadConfig`.",
    "Repository-wide headers and documentation were brought up to date to reflect the current year and platform requirements. Copyright headers were updated to year 2026, and documentation now clarifies BPF-LSM/kernel requirements (including CentOS 9 details), security module defaults, and Vagrant usage examples."
  ],
  "üêú Bug Fixes": [
    "Network connect events no longer risk reading an invalid protocol-name pointer when capturing metadata for policy decisions and visibility. The `tcp_connect` protocol name is now copied into a fixed local stack buffer using `bpf_probe_read_str` before being stored in event arguments, instead of directly using `skc_prot-\u003ename`."
  ]
}

```

### [Watch the KubeArmor v1.6 Release Overview](https://www.youtube.com/watch?v=lNXBwXRH-TQ)
<img src="https://github.com/user-attachments/assets/fbd6545c-2a7a-4ae4-91f5-87242a5b1c37" alt="KubeArmor v1.6 Release" width="600" />

## Key Features & Enhancements

### üîê **Advanced Process Arguments Matching**

- Introduced **argument-based matching for processes** in policies.

- Allows precise control over command-line arguments, enabling granular process enforcement.

- This feature is currently limited to BPFLSM.

- **Example policy:**

  ```yaml
  apiVersion: security.kubearmor.com/v1
  kind: KubeArmorPolicy
  metadata:
    name: allow-steampipe-args
  spec:
    selector:
      matchLabels:
        app: steampipe
    process:
      matchPaths:
      - path: /usr/bin/python3.6
        allowedArgs:
          - -m
          - modules.steampipe_aws
    action: Block
  ```

### ‚ûï **Add support for non-Kubernetes installation through the KubeArmor client**

### üì° **DNS Visibility at Pod-Level**

- Added **DNS query tracing** on UDP to provide insights into domain lookups from workloads.
- Helps detect malicious behaviors like **DGA (Domain Generation Algorithms)** or unauthorized C2 communications.

### üõ°Ô∏è **New Policy Presets**

- **ProtectProc:** Blocks unauthorized access to the `/proc` directory by non-owner processes.
- **ProtectEnv:** Prevents unauthorized access to sensitive environment variables in `/proc/[pid]/environ`.
- **ExecPreset:** Enforces restrictions on external process executions (e.g., via `kubectl exec`).

### üîå **Container Runtime Enhancements**

- **OCI Hooks Support:**
  - Added support for **containerd** and **CRI-O hooks**, eliminating the need for exposing runtime UNIX sockets for container events.

### üìà **Improved Telemetry and Observability**

- Added **TTY information** in BPF-LSM generated telemetry.
- Enhanced telemetry with **network metadata** using Kubernetes informers.
- Extended alert resources to include **full command arguments**.

### üåê **Ecosystem and Integrations**

- **OpenSearch Support:** Added OpenSearch as a datasource for process graphs in Grafana dashboards.
- Integrated **image vulnerability scanning workflows** (via Trivy) in release pipelines.

## üõ†Ô∏è Bug Fixes and Stability Improvements

- Resolved **memory leaks** in AppArmor DaemonSet (observed in AKS clusters).
- Fixed **policy deletion logic** for recommended policies in the operator.
- Addressed **KubeArmorClusterPolicy enforcement issue** for pods created post-policy application.
- Fixed panic errors with uninitialized Docker daemons.
- Resolved **tolerations propagation issues** in Helm chart deployments.
- Improved filtering logic in `karmor profile` commands to respect namespace, pod, and container filters.
- Fixed PID/HostPID and PPID/HostPPID display anomalies (e-notation issues).

## ‚öôÔ∏è Additional Improvements

- Helm charts updated to handle tolerations properly.
- Introduced **conditional deployment** of pod refresh controllers.
- Updated CI pipelines to use Ubuntu 22.04 runners and separated network tests for newer kernels.
- Deprecated legacy Config Watcher in favor of **karmor.yaml configuration**.

## üö® Breaking Changes

- **Preset API Specification Updated:**

  - Action is now defined per-preset level:

    ```yaml
    presets:
      - name: protectEnv
        action: Block
    ```

- Configuration changes via `karmor.yaml` will eventually replace existing ConfigMap fields.

## üìñ Documentation Updates

- Revised hardening policies and presets documentation.
- Updated multi-OS deployment instructions and CLI long descriptions.
- Added ModelArmor use-cases and a better getting started guide

## ‚úÖ Upgrade Notes

- Users are advised to review preset configurations and update CRDs accordingly.
- When upgrading from v1.5, ensure Helm charts are updated to leverage new toleration handling and configuration management features.

## üìå Contributors

This release wouldn‚Äôt have been possible without the incredible contributions from the community. Special thanks to all contributors for feature development, bug fixes, and reviews. üôå

## üîó Resources

- üìö [KubeArmor Documentation](https://docs.kubearmor.io/)
- üõ†Ô∏è [GitHub Repository](https://github.com/kubearmor/KubeArmor)
- üìù [Changelog](https://github.com/kubearmor/KubeArmor/releases)

### üîê **Advanced Process Arguments Matching**

- Introduced **argument-based matching for processes** in policies.

- Allows precise control over command-line arguments, enabling granular process enforcement.

- This feature is currently limited to BPFLSM.

- **Example policy:**

  ```yaml
  apiVersion: security.kubearmor.com/v1
  kind: KubeArmorPolicy
  metadata:
    name: allow-steampipe-args
  spec:
    selector:
      matchLabels:
        app: steampipe
    process:
      matchPaths:
      - path: /usr/bin/python3.6
        allowedArgs:
          - -m
          - modules.steampipe_aws
    action: Block
  ```

### ‚ûï **Add support for non-Kubernetes installation through the KubeArmor client**

### üì° **DNS Visibility at Pod-Level**

- Added **DNS query tracing** on UDP to provide insights into domain lookups from workloads.
- Helps detect malicious behaviors like **DGA (Domain Generation Algorithms)** or unauthorized C2 communications.

### üõ°Ô∏è **New Policy Presets**

- **ProtectProc:** Blocks unauthorized access to the `/proc` directory by non-owner processes.
- **ProtectEnv:** Prevents unauthorized access to sensitive environment variables in `/proc/[pid]/environ`.
- **ExecPreset:** Enforces restrictions on external process executions (e.g., via `kubectl exec`).

### üîå **Container Runtime Enhancements**

- **OCI Hooks Support:**
  - Added support for **containerd** and **CRI-O hooks**, eliminating the need for exposing runtime UNIX sockets for container events.

### üìà **Improved Telemetry and Observability**

- Added **TTY information** in BPF-LSM generated telemetry.
- Enhanced telemetry with **network metadata** using Kubernetes informers.
- Extended alert resources to include **full command arguments**.

### üåê **Ecosystem and Integrations**

- **OpenSearch Support:** Added OpenSearch as a datasource for process graphs in Grafana dashboards.
- Integrated **image vulnerability scanning workflows** (via Trivy) in release pipelines.

## üõ†Ô∏è Bug Fixes and Stability Improvements

- Resolved **memory leaks** in AppArmor DaemonSet (observed in AKS clusters).
- Fixed **policy deletion logic** for recommended policies in the operator.
- Addressed **KubeArmorClusterPolicy enforcement issue** for pods created post-policy application.
- Fixed panic errors with uninitialized Docker daemons.
- Resolved **tolerations propagation issues** in Helm chart deployments.
- Improved filtering logic in `karmor profile` commands to respect namespace, pod, and container filters.
- Fixed PID/HostPID and PPID/HostPPID display anomalies (e-notation issues).

## ‚öôÔ∏è Additional Improvements

- Helm charts updated to handle tolerations properly.
- Introduced **conditional deployment** of pod refresh controllers.
- Updated CI pipelines to use Ubuntu 22.04 runners and separated network tests for newer kernels.
- Deprecated legacy Config Watcher in favor of **karmor.yaml configuration**.

## üö® Breaking Changes

- **Preset API Specification Updated:**

  - Action is now defined per-preset level:

    ```yaml
    presets:
      - name: protectEnv
        action: Block
    ```

- Configuration changes via `karmor.yaml` will eventually replace existing ConfigMap fields.

## üìñ Documentation Updates

- Revised hardening policies and presets documentation.
- Updated multi-OS deployment instructions and CLI long descriptions.
- Added ModelArmor use-cases and a better getting started guide

## ‚úÖ Upgrade Notes

- Users are advised to review preset configurations and update CRDs accordingly.
- When upgrading from v1.5, ensure Helm charts are updated to leverage new toleration handling and configuration management features.

## üìå Contributors

This release wouldn‚Äôt have been possible without the incredible contributions from the community. Special thanks to all contributors for feature development, bug fixes, and reviews. üôå

## üîó Resources

- üìö [KubeArmor Documentation](https://docs.kubearmor.io/)
- üõ†Ô∏è [GitHub Repository](https://github.com/kubearmor/KubeArmor)
- üìù [Changelog](https://github.com/kubearmor/KubeArmor/releases)
